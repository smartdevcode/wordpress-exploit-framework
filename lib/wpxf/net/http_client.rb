module Wpxf
  module Net
    # Provides HTTP client functionality.
    module HttpClient
      def initialize
        super

        register_options([
          StringOption.new(
            name: 'Host',
            desc: 'The address of the target host.',
            required: true
          ),
          PortOption.new(
            name: 'Port',
            desc: 'The port the remote host is listening on',
            required: true,
            default: 80
          ),
          StringOption.new(
            name: 'VHost',
            desc: 'HTTP server virtual host'
          ),
          StringOption.new(
            name: 'Proxy',
            desc: 'A proxy string in the format of [protocol://]host:port '\
                  'HTTP, SOCKS4 SOCKS4A and SOCKS5 are supported. '\
                  'If no protocol is given, HTTP will be used'
          ),
          StringOption.new(
            name: 'TargetURI',
            desc: 'The base path to the WordPress application.',
            required: true,
            default: '/'
          )
        ])

        register_advanced_options([
          StringOption.new(
            name: 'BasicAuthCreds',
            desc: 'The HTTP credentials to use for authentication in the '\
                  'format of username:password'
          ),
          StringOption.new(
            name: 'ProxyAuthCreds',
            desc: 'The credentials to use for authentication with the proxy '\
                  ' in the format of username:password'
          ),
          BooleanOption.new(
            name: 'HostVerification',
            desc: 'Enable host verification when using HTTPS',
            required: true,
            default: true
          ),
          IntegerOption.new(
            name: 'MaxHTTPConcurrency',
            desc: 'The maximum number of HTTP requests that can be made in '\
                  'parallel (Min: 1, Max: 200)',
            required: true,
            default: 20,
            min: 1,
            max: 200
          ),
          IntegerOption.new(
            name: 'HTTPClientTimeout',
            desc: 'The maximum number of milliseconds to wait for the HTTP '\
                  'client to wait for a connection and response'
          ),
          StringOption.new(
            name: 'UserAgent',
            desc: 'The user agent string to send with all requests'
          ),
          BooleanOption.new(
            name: 'FollowHTTPRedirection',
            desc: 'Automatically follow HTTP redirections',
            required: true,
            default: true
          )
        ])
      end
    end
  end
end
