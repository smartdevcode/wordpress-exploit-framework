# Provides functionality for fingerprinting WordPress and its components.
module Wpxf::WordPress::Fingerprint
  def wordpress_fingerprint_regexes
    [
      %r{["'][^"']*\/#{Regexp.escape(wp_content_dir)}\/[^"']*["']}i,
      %r{<link rel=["']wlwmanifest["'].*href=["'].*\/wp-includes\/
        wlwmanifest\.xml["'] \/>}i,
      %r{<link rel=["']pingback["'].*href=["'].*\/xmlrpc\.php["'](?: \/)*>}i
    ]
  end

  def wordpress_and_online?
    res = execute_get_request(full_uri)

    return false unless res && res[:code] == 200
    return true if wordpress_fingerprint_regexes.any? { |r| res[:body] =~ r }
    false
  end
end
