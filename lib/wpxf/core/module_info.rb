module Wpxf
  # Provides functionality for specifying module metadata.
  module ModuleInfo
    def initialize
      super
      @info = {}
    end

    # Update the module info.
    # @param info [Hash] a hash containing the module info.
    def update_info(info)
      required_keys = [:author, :type, :date]
      if required_keys.all? { |key| info.key? key }
        fail 'Missing one or more required module info keys'
      end

      @info = info
      @info[:date] = Date.parse(@info[:date].to_s)
    end

    # @return [String] the name of the module author(s).
    def module_author
      @info[:author]
    end

    # @return [Symbol] the module type (:auxiliary or :exploit).
    def module_type
      @info[:type]
    end

    # @return [Date] the disclosure date of the vulnerability.
    def module_date
      @info[:date]
    end
  end
end
