require_relative '../spec_helper'

describe Wpxf::WordPress::User do
  # Dummy class for tests.
  class Subject < Wpxf::Module
    include Wpxf::Net::HttpClient
    include Wpxf::WordPress::Options
    include Wpxf::WordPress::Urls
    include Wpxf::WordPress::User
  end

  let(:body) { '' }
  let(:code) { 200 }
  let(:subject) do
    subject = Subject.new
    subject.set_option_value('host', '127.0.0.1')
    subject.set_option_value('target_uri', '/wp/')
    subject
  end

  before :each do
    res = Wpxf::Net::HttpResponse.new(nil)
    res.body = body
    res.code = code

    allow(subject).to receive(:execute_post_request).and_return(res)
  end

  describe '#wordpress_user_exists?' do
    let(:body) { 'Incorrect password' }
    it 'returns true if the login response indicates the user exists' do
      expect(subject.wordpress_user_exists?('foo')).to be true
    end
  end
end
